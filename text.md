# ネットワーク周りの技術

## API
ソフトウェア同士のデータのやり取り。

## ハイパーテキスト
Webページを構成する言語。

## HTTP
ハイパーテキストのやりとりに用いられるフォーマット。手順書。HTTPというルールがあるおかげで、異なる環境でのハイパーテキストのやりとりができる。

## CGI
ブラウザからのリクエストが動的処理を求めるものだった場合、Webサーバーがサーバーサイドスクリプト（Ruby,Pythonなど）を起動する仕組み。

## RESTful
RESTの原則

- 統一インターフェース
  - HTTPに従ってデータのやり取りを行う（リソースの作成はPOST、リソースの取得はGETなど）
- アドレス可能性
  - リソースと、それを示すURLが１対１の関係にあること。（http://.../aboutとリクエストしたらaboutリソースを返す。それ以外は返さない。）
- 接続性
  - やり取りされるデータにはリンクを含めることができる。
- ステートレス性
  - リクエストとレスポンスは１回ごとに完結。前のリクエストの情報を保持しない。

## セマンティックWeb
コンピュータ自身が自律的にデータの意味を理解し、処理することを可能とするもの。情報を自動的に収集したり、有益な情報を選定したりを、コンピュータ自身に行わせることができるようになる。セマンティックWebの実現のためには、データの意味を示すデータ、メタデータなどが必要となる。

## ドメイン
- IPアドレスの別名
- "http://example.com:80/test.html"の「example.com」の部分。

## DNSサーバー
ドメインをIPアドレスに変換する仕組みをDNSと呼び。そのサービスを提供しているサーバーをDNSサーバーと呼ぶ。

## HTTP
クライアントとサーバ間においてWebコンテンツを送受信するためのプロトコル。

## HTTPメッセージ
HTTPメッセージにはHTTPリクエストとHTTPレスポンスの２種類がある。

## HTTPリクエスト
HTTPリクエストは「リクエスト行」「メッセージヘッダー」「メッセージボディ」の３つに分けることができる。

[「HTTP」の仕組みをおさらいしよう](http://www.atmarkit.co.jp/ait/articles/1508/31/news016_3.html)

- リクエスト行
  - Webサーバーにしてもらいたい処理のリクエストの要求内容
- メッセージヘッダー
  - Webブラウザの種類やバージョンなど付加的情報
- メッセージボディ
  - フォームなどに入力した内容

## HTTPレスポンス
HTTPレスポンスは「ステータス行」「メッセージヘッダー」「メッセージボディ」からなる。

- ステータス行
  - HTTPリクエストに対して、Webサーバ内の処理の結果を伝える。(ステータスコード（200や402）など)
- メッセージヘッダー
  - Webサーバの種類や、送信データ形式など付加的情報
- メッセージボディ
  - リクエストされたHTMLなどのデータ。

## ステータスコード

- 100番台
  - HTTPリクエストが処理中であることを示す。
- 200番台
  - HTTPリクエストが正常に処理されたことを示す。
- 300番台
  - HTTPリクエストに対して転送処理などの追加の処理が必要なことを示す。
    - 301: 永続的な移動
    - 302: 一時的な移動
    - 303: コンテンツが未更新。一時保存されたコンテンツを表示
- 400番台
  - クライアント側のエラーを示す。
    - 400: リクエストが不正
    - 404: リクエストされたコンテンツを見つけられない
- 500番台
  - サーバ側のエラーを示す。
    - 500: リクエスト処理中にサーバーでエラーが生じた
    - 503: アクセス集中やメンテナンスで一時的に処理不可

## メッセージヘッダー
HTTPメッセージに関する詳細な情報が記述されている。
複数のメッセージヘッダーと呼ばれる行から成り立つ。
主なメッセージフィールドは「一般ヘッダーフィールド」「リクエストヘッダーフィールド」「レスポンスヘッダーフィールド」「エンティティヘッダーフィールド」

- 一般ヘッダーフィールド
  - 代表的なもの：HTTPメッセージが作成された日付を示す「Date」
- リクエストヘッダーフィールド
  - 代表的なもの：Webブラウザの固有情報を示す「User-Agent」。これによりPCとスマホで処理を分けることができる。
- レスポンスヘッダーフィールド
  - 代表的なもの：サーバの固有情報を示す「Server」
- エンティティヘッダーフィールド
  - 代表的なもの：メッセージボディのデータの種類を示す「Content-Type」

## TCPによるデータ通信の仕組み
クライアントとサーバがデータの送受信ができる状態なのかを確認し、「コネクション」と呼ばれる通信経路を作る。（車が通行するために道路を作るようなもの）

1. クライアントがサーバーに接続を要求するためのデータを送る（**SYNパケット**）
2. サーバ側はSYNパケットを受け取ったことを知らせるデータ（**ACKパケット**）を送る。また、クライアントに接続を要求するためにSYNパケットを送る。
3. クライアント側はSYNパケットを受け取ったことを知らせるためにACKパケットを送る。

## HTTP/1.1のやりとり
以前は一つのHTTPメッセージが終わるごとにコネクションを切断していたが、HTTP/1.1以降はコネクションを継続して利用できるようにした。この機能を**HTTPキープアライブ**と呼ぶ。

HTTPは通常リクエストとレスポンスが一対一の関係にあり、レスポンスが返ってこないうちは新たにリクエストを送れないが、**HTTPパイプライン**という機能を利用することにより、レスポンスを待つことなく複数のリクエストを送れるようになった。

## HTTP/2のやりとり
1.1ではパイプライン機能を使ってレスポンスを待つことなく複数のリクエストを送れるようにしていたが、この機能にはリクエストの順番通りにしかレスポンスを返さないという制約がある。この制約により、ある一つのHTTPリクエストの処理に時間がかかる場合、それ以降のHTTPリクエストは待っていなければならない。この問題を解決するために、2.0ではコネクション上に**ストリーム**と呼ばれる仮想的な通信経路を作り、各ストリームでHTTPリクエストとHTTPレスポンスのやりとりを可能にした。

## HTTP/2での改良点

- バイナリ形式の利用
1.1ではテキスト形式でやりとりしていたが、バイナリ形式に変更。これによって、処理時間が早くなり、サーバーの負担も減った。
- ヘッダー情報の圧縮
ヘッダー情報には重複したデータが多いため、差分だけを送る方式に変更。データ転送量を削減できる。
- サーバープッシュ？

## HTTPSの仕組み
SSLとTLSという暗号化方式を使う。

- データを暗号化し、盗聴防止
- メッセージダイジェストを利用し、改ざん防止。
ハッシュ関数を用いてデータを一定の長さの「ハッシュ値」する。そのハッシュ値を送受信時に比較しする。
- なりすまし防止
「SSLサーバー証明書」と呼ばれる電子証明書をWebサーバーに置くことで、Webサイトの閲覧者に対して身分証明をしている。

## Cookie
- Webサーバーがブラウザに対して、コンテンツと一緒にブラウザに保存してもらいたい情報をCookieとして送る。
- 次にサーバーにリクエストを送る際、Cookieも送信することでサーバーはブラウザを識別できる。
- サーバーはHTTPレスポンスに**Set-Cookieヘッダー**を含めることでCookieを送信でき、ブラウザはHTTPリクエストに**Cookieヘッダー**を含めることで送信できる。
- Set-CookieヘッダーにはオプションでCookieの有効期限を設定したり、また、HTTPSのみ利用してCookieを送信する設定をしたりできる。
- 有効期限が設定されていないCookieはブラウザうを閉じると同時に削除される。このようなCookieを**セッションCookie**と呼ぶ

## セッション
- セッションとは関連性のある処理の流れ
- セッションIDはWebサーバーで生成され、Cookieに含めてブラウザに送信される。セッションIDを受け取ったブラウザは次回以降、CookieにセッションIDに含めて処理を行うことで、サーバとのセッションを維持できる。また、セッション内でやり取りされた「なんの商品を買い物カゴに入れたのか」などの処理は、セッションIDと紐づいて「セッションデータ」としてサーバーに保存される。

## URIとは
- コンピューターの扱うリソースに限らずあらゆるリソースを示すことができる。
- その中でも、URLはリソースの場所を示すもの。
- また、URLとは異なりリソースの名前を示すものをURNという。URNの例としてISBNコードがある。

## パーセントエンコーディング
URIでは予約文字（!,#,$などの記号）と非予約文字（半角の英数字など）しか用いることができない。それ以外の文字、日本語などは**パーセントエンコーディング**と呼ばれる方法を用いて、16進数と%記号で表示される。


## Webアプリケーションの3層構造とは？
Webアプリケーションは基本的に３層構造である。

- ユーザーインターフェースとなる**プレゼンテーション層**
    -  ブラウザとWebサーバー
- 業務処理を行う**アプリケーション層**
    - APサーバー
- データ処理や保管を行う**データ層**
    - DBサーバー

## Webアプリケーションを３層構造にするメリット
- 負荷分散
    - 各処理を分散させることで、サーバーへの負荷を軽減できる。
- 改修範囲の限定
    - 処理槽を分散することで、各処理で起こったエラーに個別に対処できる。

## データベースの冗長化方法
- ミラーリング
    - データベースの更新命令を受けたプリンシパルDBMSがミラーDBMSに対して同時に同じ更新処理を行うこと
- レプリケーション
    - 更新命令を受けたマスタDBMSがスレーブDBMSに更新処理を送り、更新履歴を受け取ったスレーブDBMSは任意のタイミングで更新を行う。
- シェアードディスク
    - 共用の機器にデータベースを置き、複数のDBMSからそれを更新する。

## キャッシュ
- リクエストに対するレスポンスの記憶のこと。
- あるリクエストに対し、同じレスポンスを返す。
- キャッシュの役割を実現するために必要なのが**キャッシュサーバー**というプログラム
- 文書や画像といったコンテンツのキャッシュが**コンテンツキャッシュ**
- DBMSのデータ検索要求の結果のキャッシュが**クエリキャッシュ**
- 動画などのリクエストあった場合、コンテンツキャッシュサーバーが記憶しているリクエストであれば、WEbサーバの代わりにレスポンスを返すことで、Webサーバーの負荷を減らすことだできる。

## CDN
世界各地のコンテンツキャッシュサーバーで構成されるネットワーク

## 同期通信
クライアントがリクエストしたら、サーバーがレスポンスを返すまで、クライアント側は待たなければならない。

## Ajax
- ブラウザ上でJavascriptがサーバーと通信を行い、更新に必要なデータのみをやり取りする。そのため、サーバーへの負担を抑えることができる。
- サーバーからのレスポンスを待つ間も、Javascriptがレスポンスに左右されない箇所の更新を行ったり、ユーザからの入力を受け付けたりできる。非同期通信を可能にする。

## マッシュアップ
プログラムが複数のWebサービスを組み合わせて新たなWebサービスを作り出すこと。

## パスワードクラッキング
ユーザーのパスワードを抜き出そうとする攻撃のこと。主な手法は次の二つ。
- 辞書攻撃
    - パスワードに頻繁に使われる単語をまとめたファイル（辞書）を用意しておいて、それと使って次々に試す方法

- ブルートフォース攻撃
    - パスワードに使われる全組み合わせをしらみつぶしに試す方法

## DoS攻撃
短期間にサーバーが処理しきれないほどの大量のアクセスを行うことで、サービス停止に陥らせる攻撃のこと。主な攻撃手法は二つ
- SYN Flood攻撃
    - SYNパケットだけを大量に送りつけ、サーバーを接続待ち状態にすることで別のユーザーからからの新たな接続をできないようにする方法
- F5攻撃
    - 繰り返しアクセスし続けることで、リクエストへの反応ができないレベルまでWebサーバーの負荷を高める方法。

## セッションハイジャック
何らかの手段を用いて第三者がCookieの中身やセッションIDを取得し、ログイン済みユーザーになりすまし、個人情報を取得すること

## ディレクトリトラバーサル
URLの指定方を工夫し、Webで公開されていないディレクトリにアクセスすることで、ログインパスワードなどを取得すること

## クロスサイトスクリプティング(XSS)
攻撃者が製作した悪意のあるページ（B）にアクセスしたユーザーがB内でスクリプトを実行し、その情報を保持したまま、XSSの脆弱性があるサイト（A）に移動すると、スクリプトの効果により偽のA（A'）が表示される。A'でユーザ情報を入力したユーザはマルウェアの感染などの被害を被る

## スクリプト
人間がコンパイルする必要がないプログラムのこと

## クロスサイトリクエストフォージュリ(CSRF)
オンラインサービスを利用するユーザーがログイン状態を保持したまま悪意のある第三者の作成したURLなどをクリックした場合などに、本人が意図しない形で情報・リクエストを送信されてしまうことを意味します。

## SQLインジェクション
「SQLインジェクション」とは、WebアプリケーションからのデータベースアクセスにSQLを使用していて、その呼び出し方に不備があるときに発生する脆弱性（ぜいじゃくせい）のことです。
たとえば、Webサイトに設置されている”お問い合わせフォーム”は氏名や連絡先など個人情報を入力しますが、対策が十分でないと、不正な処理を含んだSQL文が実行され、データベースに保存されている情報を不正に閲覧されてしまうなどの影響があります。

## セキュリティホール
情報セキュリティを脅かすソフトウェアの欠陥のこと。発見されたセキュリティホールは脆弱性情報データベースに登録され、製品の開発元から提供される修正プログラム（セキュリティパッチ）を適用することで対策する

## ゼロデイ攻撃
発見されたセキュリティホールに対するセキュリティパッチが開発される前に、セキュリティホールを利用した攻撃を仕掛けること。

## ファイアーヴォール
インターネットと内部ネットワークの間に設置し、送受信されるデータを監視して、通信の許可・拒否を行うもの。

## パケットフィルタ型ファイアーヴォール
送受信されるデータ（パケット）のIPアドレスとポート番号をチェックし、通信の許可・拒否の判断を行います。　

## IDS,IPS
通信を監視するネットワーク型と、サーバー上のユーザーの動きを監視するホスト型の２種類ある。

- ネットワーク型IDS、IPS
ネットワーク上を流れる通信を監視し、不正アクセスとみられる通信や普段と異なる以上な通信を検知する装置。
    - **IDSとIPSの違い**
    IDSは以上があったことをシステム管理者にメールなどで通知し、IPSは通知だけでなく、即座に該当する通信の遮断を行う。

    - **IPSのデメリット**
    IPSの方が強固なセキュリティを実現できるが、不正な通信だけでなく、正常な通信を不正な通信と誤って判断（誤検知）してしまうことがある。
    誤検知が発生した場合、正常な通信が遮断されてしまう。

## IPSとIDSの検知方法
- **シグネチャ型**
シグネチャは既知の攻撃手法における通信パターンが登録されたデータベースのこと。
監視対象の通信とシグネチャを比較し、シグネチャに登録されたパターンと一致する通信を不正なアクセスと判断する。
- **アノマリー型**
普段の通信とは大きく異なる通信や、通常は発生しないような通信を不正アクセスと判断する検知方法。

## WAF
やり取りされるパケットの中身を見て悪意のあるデータが含まれていないかをチェックする検知方法。
- **ブラックリスト型**
遮断するべきデータのパターン（ブラックリスト）のデータを持つ通信を遮断する。しかし、新たな攻撃方法が発見された場合、ブラックリストにそのパターンが登録されるまで防ぐことができない。
- **ホワイトリスト型**
正常なデータのパターン（ホワイトリスト）を登録しておき、それに適合する通信のみを通す。しかし、正確なホワイトリストの作成にはコストがかかる。

## 暗号化
元のデータ（平文）を暗号化の手段（暗号化アルゴリズム）で第三者が読み取れないデータ（暗号文）にすることです。受け取った暗号文を平文に戻すことを復号と呼ぶ。

## ハッシュ化
ハッシュ関数と呼ばれる計算式によって任意の長さの文字列を固定長の文字列（ハッシュ値）に変換すること。

## 公開鍵証明書の役割
- HTTS通信に使うための公開鍵の持ち主が誰なのかを証明する。
- 公開鍵の持ち主が実在することを証明すること
事故証明書というものも存在するが、これは身内が発行したもので、認証局が発行したものではないため、暗号化通信はできるが、通信先のサイトを保証するものではない。

## 認証
通信の相手が誰（何）であるかを確認すること

## 認証API

## OpenID

## 認可
とある特定の条件に対して、リソースアクセスの権限を与えること
[参考リンク](http://www.itmedia.co.jp/enterprise/articles/0804/22/news044.html)

## OAuth
読み方は「オーオース」。認可のみ行い、認証は行わない。

## CAPTCHA
プログラムを用いたWebサービスの悪用を防ぐために考案されたもの。
例：　サインアップやサインイン時の「文字の読み取り」「画像の選択」「簡単なパズル」など。

## ミドルウェア
OSとアプリケーションの中間に位置するプログラムのこと。WebサーバーやAPサーバー、DBMSがこれに当たる。

## ネットワークの分割
Webシステムを構成するネットワークは大きく３種類に分割される。
- 外部ネットワーク
    - インターネットにさらされるネットワーク。ファイアーヴォールより外側にある。
- 内部ネットワーク
    - インターネットから隔離されたネットワーク。
- DMZ
    - 外部ネットワークと内部ネットワークの境界に位置し、外部外部ネットワークおよび内部ネットワーク両方からのアクセスを受け付けつつ、不正な通信を防ぐため内部ネットワークへの通信を制限するもの

## ロードバランサー
送られてきたリクエストをWebサーバーに振り分ける役割。
- 送られてきたリクエストをロードバランサが一旦全て受け取り、そのリクエストを配下のWebサーバーに均等に転送することで各Webサーバーの負荷を平準化しつつ、リクエストを処理させる。

### ロードバランサーの種類
- ラウンドロビン方式
各サーバーに順番にリクエストを割り振る方式。
- 動的分散方式
負荷が少ないサーバーに優先してリクエストを割り振る方式。
- パーシステンス
負荷分散を行うと同一のクライアントからのリクエストも振り分けられるサーバーが異なるため、セッション情報を管理することが難しい。そこで、同一のクライアントからのリクエストを判別し、常に同じサーバーへ転送する機能が開発され、これをパーシステンスを呼ぶ。



